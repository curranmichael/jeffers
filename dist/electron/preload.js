"use strict";var o=require("electron");var N="profile:get",P="bookmarks:import",k="file:saveTemp",s="bookmarks:progress",v="chat:stream:start",R="chat:stream:stop",i="chat:onResponseChunk",l="chat:onStreamEnd",a="chat:onStreamError",u="chat:getMessages",m="slices:getDetails",A="intent:set",c="intent:on-result",S="notebook:create",E="notebook:getById",T="notebook:getAll",g="notebook:update",_="notebook:delete",O="notebook:getChunks",p="chatSession:createInNotebook",d="chatSession:listForNotebook",I="chatSession:transferToNotebook";console.log("[Preload Script] Loading...");var C={getAppVersion:()=>(console.log("[Preload Script] Requesting app version via IPC"),o.ipcRenderer.invoke("get-app-version")),getProfile:()=>(console.log("[Preload Script] Requesting profile via IPC"),o.ipcRenderer.invoke(N)),importBookmarks:e=>(console.log("[Preload Script] Invoking bookmarks import via IPC"),o.ipcRenderer.invoke(P,e)),saveTempFile:(e,t)=>(console.log("[Preload Script] Invoking save temp file via IPC"),o.ipcRenderer.invoke(k,{fileName:e,data:t})),onBookmarksProgress:e=>{console.log("[Preload Script] Setting up listener for",s);let t=(n,r)=>{e(r)};return o.ipcRenderer.on(s,t),()=>{console.log("[Preload Script] Removing listener for",s),o.ipcRenderer.removeListener(s,t)}},startChatStream:(e,t)=>{if(!e||!t){console.error("[Preload Script] startChatStream called with invalid sessionId or question.");return}console.log(`[Preload Script] Sending CHAT_STREAM_START for session: ${e}, question: "${t.substring(0,30)}..."`),o.ipcRenderer.send(v,{sessionId:e,question:t})},stopChatStream:()=>{console.log("[Preload Script] Sending CHAT_STREAM_STOP"),o.ipcRenderer.send(R)},onChatChunk:e=>{let t=(n,r)=>e(r);return o.ipcRenderer.on(i,t),()=>o.ipcRenderer.removeListener(i,t)},onChatStreamEnd:e=>{let t=(n,r)=>e(r);return o.ipcRenderer.on(l,t),()=>o.ipcRenderer.removeListener(l,t)},onChatStreamError:e=>{let t=(n,r)=>e(r);return o.ipcRenderer.on(a,t),()=>o.ipcRenderer.removeListener(a,t)},getMessages:(e,t,n)=>(console.log(`[Preload Script] Invoking getMessages for session: ${e}, limit: ${t}`),o.ipcRenderer.invoke(u,{sessionId:e,limit:t,beforeTimestamp:n})),getSliceDetails:e=>(console.log(`[Preload Script] Invoking getSliceDetails for ${e.length} IDs: [${e.slice(0,5).join(", ")}]...`),!Array.isArray(e)||e.some(t=>typeof t!="number")?(console.error("[Preload Script] getSliceDetails called with invalid input (must be array of numbers)."),Promise.reject(new Error("Invalid input: chunkIds must be an array of numbers."))):o.ipcRenderer.invoke(m,e)),setIntent:e=>(console.log("[Preload Script] Sending SET_INTENT with payload:",e.intentText.substring(0,50)+"..."),o.ipcRenderer.invoke(A,e)),onIntentResult:e=>{console.log("[Preload Script] Setting up listener for ON_INTENT_RESULT");let t=(n,r)=>{e(r)};return o.ipcRenderer.on(c,t),()=>{console.log("[Preload Script] Removing listener for ON_INTENT_RESULT"),o.ipcRenderer.removeListener(c,t)}},createNotebook:e=>(console.log(`[Preload Script] Invoking ${S}`),o.ipcRenderer.invoke(S,e)),getNotebookById:e=>(console.log(`[Preload Script] Invoking ${E} for ID: ${e}`),o.ipcRenderer.invoke(E,e)),getAllNotebooks:()=>(console.log(`[Preload Script] Invoking ${T}`),o.ipcRenderer.invoke(T)),updateNotebook:e=>(console.log(`[Preload Script] Invoking ${g} for ID: ${e.id}`),o.ipcRenderer.invoke(g,e)),deleteNotebook:e=>(console.log(`[Preload Script] Invoking ${_} for ID: ${e}`),o.ipcRenderer.invoke(_,e)),getChunksForNotebook:e=>(console.log(`[Preload Script] Invoking ${O} for notebook ID: ${e}`),o.ipcRenderer.invoke(O,e)),createChatInNotebook:e=>(console.log(`[Preload Script] Invoking ${p} for notebook ID: ${e.notebookId}`),o.ipcRenderer.invoke(p,e)),listChatsForNotebook:e=>(console.log(`[Preload Script] Invoking ${d} for notebook ID: ${e}`),o.ipcRenderer.invoke(d,e)),transferChatToNotebook:e=>(console.log(`[Preload Script] Invoking ${I} for session ID: ${e.sessionId}`),o.ipcRenderer.invoke(I,e))};try{o.contextBridge.exposeInMainWorld("api",C),console.log("[Preload Script] API exposed successfully.")}catch(e){console.error("[Preload Script] Failed to expose API:",e)}
//# sourceMappingURL=preload.js.map
