"use strict";var o=require("electron");var f="profile:get",b="profile:update",L="activity:log:add",B="bookmarks:import",y="file:saveTemp",i="bookmarks:progress",h="chat:stream:start",x="chat:stream:stop",l="chat:onResponseChunk",a="chat:onStreamEnd",c="chat:onStreamError",G="chat:getMessages",U="slices:getDetails",F="intent:set",S="intent:on-result",E="notebook:create",d="notebook:getById",g="notebook:getAll",_="notebook:update",P="notebook:delete",T="notebook:getChunks",p="chatSession:createInNotebook",I="chatSession:listForNotebook",R="chatSession:transferToNotebook",O="store:get",v="store:set",u="store:remove",M="main:request-renderer-flush",C="renderer:flush-complete",w="todo:create",H="todo:getAll",$="todo:getById",K="todo:update",W="todo:delete",V="browser:create",Y="browser:navigate",q="browser:loadUrl",Q="classic-browser:set-bounds",j="classic-browser:set-visibility",A="on-classic-browser-state",z="browser:destroy",N="classic-browser-view-focused",m="classic-browser-request-focus";var J="pdf:ingest:request",k="pdf:ingest:progress",D="pdf:ingest:batch-complete",X="pdf:ingest:cancel";console.log("[Preload Script] Loading...");var s={getAppVersion:()=>(console.log("[Preload Script] Requesting app version via IPC"),o.ipcRenderer.invoke("get-app-version")),getProfile:()=>(console.log("[Preload Script] Requesting profile via IPC"),o.ipcRenderer.invoke(f)),updateProfile:e=>(console.log("[Preload Script] Updating profile via IPC"),o.ipcRenderer.invoke(b,e)),logActivity:e=>(console.log("[Preload Script] Logging activity via IPC"),o.ipcRenderer.invoke(L,e)),importBookmarks:e=>(console.log("[Preload Script] Invoking bookmarks import via IPC"),o.ipcRenderer.invoke(B,e)),saveTempFile:(e,t)=>(console.log("[Preload Script] Invoking save temp file via IPC"),o.ipcRenderer.invoke(y,{fileName:e,data:t})),onBookmarksProgress:e=>{console.log("[Preload Script] Setting up listener for",i);let t=(n,r)=>{e(r)};return o.ipcRenderer.on(i,t),()=>{console.log("[Preload Script] Removing listener for",i),o.ipcRenderer.removeListener(i,t)}},startChatStream:e=>{let{notebookId:t,sessionId:n,question:r}=e;if(!t||!n||!r){console.error("[Preload Script] startChatStream called with invalid payload.",e);return}console.log(`[Preload Script] Sending CHAT_STREAM_START for notebook: ${t}, session: ${n}, question: "${r.substring(0,30)}..."`),o.ipcRenderer.send(h,e)},stopChatStream:()=>{console.log("[Preload Script] Sending CHAT_STREAM_STOP"),o.ipcRenderer.send(x)},onChatChunk:e=>{let t=(n,r)=>e(r);return o.ipcRenderer.on(l,t),()=>o.ipcRenderer.removeListener(l,t)},onChatStreamEnd:e=>{let t=(n,r)=>e(r);return o.ipcRenderer.on(a,t),()=>o.ipcRenderer.removeListener(a,t)},onChatStreamError:e=>{let t=(n,r)=>e(r);return o.ipcRenderer.on(c,t),()=>o.ipcRenderer.removeListener(c,t)},getMessages:(e,t,n)=>(console.log(`[Preload Script] Invoking getMessages for session: ${e}, limit: ${t}`),o.ipcRenderer.invoke(G,{sessionId:e,limit:t,beforeTimestamp:n})),getSliceDetails:e=>(console.log(`[Preload Script] Invoking getSliceDetails for ${e.length} IDs: [${e.slice(0,5).join(", ")}]...`),!Array.isArray(e)||e.some(t=>typeof t!="number")?(console.error("[Preload Script] getSliceDetails called with invalid input (must be array of numbers)."),Promise.reject(new Error("Invalid input: chunkIds must be an array of numbers."))):o.ipcRenderer.invoke(U,e)),setIntent:e=>(console.log("[Preload Script] Sending SET_INTENT with payload:",e.intentText.substring(0,50)+"..."),o.ipcRenderer.invoke(F,e)),onIntentResult:e=>{console.log("[Preload Script] Setting up listener for ON_INTENT_RESULT");let t=(n,r)=>{e(r)};return o.ipcRenderer.on(S,t),()=>{console.log("[Preload Script] Removing listener for ON_INTENT_RESULT"),o.ipcRenderer.removeListener(S,t)}},createNotebook:e=>(console.log(`[Preload Script] Invoking ${E}`),o.ipcRenderer.invoke(E,e)),getNotebookById:e=>(console.log(`[Preload Script] Invoking ${d} for ID: ${e}`),o.ipcRenderer.invoke(d,e)),getAllNotebooks:()=>(console.log(`[Preload Script] Invoking ${g}`),o.ipcRenderer.invoke(g)),updateNotebook:e=>(console.log(`[Preload Script] Invoking ${_} for ID: ${e.id}`),o.ipcRenderer.invoke(_,e)),deleteNotebook:e=>(console.log(`[Preload Script] Invoking ${P} for ID: ${e}`),o.ipcRenderer.invoke(P,e)),getChunksForNotebook:e=>(console.log(`[Preload Script] Invoking ${T} for notebook ID: ${e}`),o.ipcRenderer.invoke(T,e)),createChatInNotebook:e=>(console.log(`[Preload Script] Invoking ${p} for notebook ID: ${e.notebookId}`),o.ipcRenderer.invoke(p,e)),listChatsForNotebook:e=>(console.log(`[Preload Script] Invoking ${I} for notebook ID: ${e}`),o.ipcRenderer.invoke(I,e)),transferChatToNotebook:e=>(console.log(`[Preload Script] Invoking ${R} for session ID: ${e.sessionId}`),o.ipcRenderer.invoke(R,e)),storeGet:e=>(console.log(`[Preload Script] Invoking ${O} for key: ${e}`),o.ipcRenderer.invoke(O,e)),storeSet:(e,t)=>(console.log(`[Preload Script] Invoking ${v} for key: ${e}`),o.ipcRenderer.invoke(v,{key:e,value:t})),storeRemove:e=>(console.log(`[Preload Script] Invoking ${u} for key: ${e}`),o.ipcRenderer.invoke(u,e)),onMainRequestFlush:e=>{let t=async n=>{console.log("[Preload Script] Received MAIN_REQUEST_RENDERER_FLUSH");try{await e(),console.log("[Preload Script] Renderer flush callback completed. Sending RENDERER_FLUSH_COMPLETE."),o.ipcRenderer.send(C)}catch(r){console.error("[Preload Script] Error during renderer flush callback:",r),o.ipcRenderer.send(C)}};o.ipcRenderer.on(M,t)},classicBrowserCreate:(e,t,n)=>o.ipcRenderer.invoke(V,e,t,n),classicBrowserLoadUrl:(e,t)=>o.ipcRenderer.invoke(q,e,t),classicBrowserNavigate:(e,t)=>o.ipcRenderer.invoke(Y,e,t),classicBrowserSetBounds:(e,t)=>{o.ipcRenderer.send(Q,e,t)},classicBrowserSetVisibility:(e,t,n)=>{o.ipcRenderer.send(j,e,t,n)},classicBrowserDestroy:e=>o.ipcRenderer.invoke(z,e),onClassicBrowserState:e=>{let t=(n,r)=>e(r);return o.ipcRenderer.on(A,t),()=>{o.ipcRenderer.removeListener(A,t)}},onClassicBrowserViewFocused:e=>{let t=(n,r)=>e(r);return o.ipcRenderer.on(N,t),()=>o.ipcRenderer.removeListener(N,t)},classicBrowserRequestFocus:e=>{console.log(`[Preload Script] Sending ${m} for windowId: ${e}`),o.ipcRenderer.send(m,e)},createToDo:e=>(console.log("[Preload Script] Creating todo via IPC"),o.ipcRenderer.invoke(w,e)),getToDos:e=>(console.log("[Preload Script] Getting todos via IPC"),o.ipcRenderer.invoke(H,e)),getToDoById:e=>(console.log("[Preload Script] Getting todo by ID via IPC"),o.ipcRenderer.invoke($,e)),updateToDo:(e,t)=>(console.log("[Preload Script] Updating todo via IPC"),o.ipcRenderer.invoke(K,{id:e,payload:t})),deleteToDo:e=>(console.log("[Preload Script] Deleting todo via IPC"),o.ipcRenderer.invoke(W,e)),ingestPdfs:e=>(console.log("[Preload Script] Requesting PDF ingestion via IPC"),o.ipcRenderer.invoke(J,{filePaths:e})),onPdfIngestProgress:e=>{console.log("[Preload Script] Setting up listener for PDF_INGEST_PROGRESS");let t=(n,r)=>{e(r)};return o.ipcRenderer.on(k,t),()=>{console.log("[Preload Script] Removing listener for PDF_INGEST_PROGRESS"),o.ipcRenderer.removeListener(k,t)}},onPdfIngestBatchComplete:e=>{console.log("[Preload Script] Setting up listener for PDF_INGEST_BATCH_COMPLETE");let t=(n,r)=>{e(r)};return o.ipcRenderer.on(D,t),()=>{console.log("[Preload Script] Removing listener for PDF_INGEST_BATCH_COMPLETE"),o.ipcRenderer.removeListener(D,t)}},cancelPdfIngest:()=>{console.log("[Preload Script] Sending PDF_INGEST_CANCEL"),o.ipcRenderer.send(X)},...process.env.NODE_ENV!=="production"?{getFullProfile:(e="default_user")=>(console.log("[Preload Script] Getting full profile via IPC (debug)"),o.ipcRenderer.invoke("debug:getFullProfile",e)),getRecentActivities:(e=24)=>(console.log("[Preload Script] Getting recent activities via IPC (debug)"),o.ipcRenderer.invoke("debug:getRecentActivities",e)),forceSynthesis:(e="both")=>(console.log("[Preload Script] Forcing synthesis via IPC (debug)"),o.ipcRenderer.invoke("debug:forceSynthesis",e)),getSynthesisState:()=>(console.log("[Preload Script] Getting synthesis state via IPC (debug)"),o.ipcRenderer.invoke("debug:getSynthesisState")),clearProfile:()=>(console.log("[Preload Script] Clearing profile via IPC (debug)"),o.ipcRenderer.invoke("debug:clearProfile"))}:{}};try{o.contextBridge.exposeInMainWorld("api",s),console.log("[Preload Script] API exposed successfully.")}catch(e){console.error("[Preload Script] Failed to expose API:",e)}if(process.env.NODE_ENV!=="production"){let e={getProfile:s.getProfile,getFullProfile:s.getFullProfile,getRecentActivities:s.getRecentActivities,forceSynthesis:s.forceSynthesis,getSynthesisState:s.getSynthesisState,clearProfile:s.clearProfile};try{o.contextBridge.exposeInMainWorld("electron",e),console.log("[Preload Script] Debug API exposed on window.electron")}catch(t){console.error("[Preload Script] Failed to expose debug API:",t)}}
//# sourceMappingURL=preload.js.map
